<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">
<head>
    <title>채팅 목록</title>
</head>
<body>
<div layout:fragment="content">
    <h1>채팅 목록</h1>
    <div th:if="${#lists.isEmpty(chatRooms)}">
        <p>채팅방이 없습니다.</p>
    </div>
    <ul th:unless="${#lists.isEmpty(chatRooms)}">
        <li th:each="chatRoom : ${chatRooms}" style="margin-bottom: 10px; list-style: none; display: flex; align-items: center; gap: 10px;">
            <a th:href="@{/chat/{roomId}(roomId=${chatRoom.id})}" style="text-decoration: none; color: black; flex-grow: 1;">
                <span th:text="${chatRoom.product.title}" style="font-weight: bold;">상품 제목</span> -
                <span th:if="${session.user.name == chatRoom.buyer.username}" th:text="${chatRoom.seller.username}">상대방</span>
                <span th:unless="${session.user.name == chatRoom.buyer.username}" th:text="${chatRoom.buyer.username}">상대방</span>
            </a>
            <form th:action="@{/chat/room/{roomId}/delete(roomId=${chatRoom.id})}" method="post" onsubmit="return confirm('정말 이 채팅방을 삭제하시겠습니까? 삭제 시 대화 내용이 모두 사라지며 상대방도 대화할 수 없게 됩니다.');">
                <button type="submit" style="background-color: #ff4d4d; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">삭제</button>
            </form>
        </li>
    </ul>
</div>
</body>
</html>
