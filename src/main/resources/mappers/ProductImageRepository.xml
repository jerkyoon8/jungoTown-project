<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.juwon.springcommunity.repository.ProductImageRepository">

    <insert id="saveAll" parameterType="java.util.List">
        INSERT INTO product_image (product_id, original_file_name, stored_file_name, file_path, file_size, created_date, modified_date)
        VALUES
        <foreach collection="list" item="image" separator=",">
            (#{image.productId}, #{image.originalFileName}, #{image.storedFileName}, #{image.filePath}, #{image.fileSize}, NOW(), NOW())
        </foreach>
    </insert>

    <select id="findByProductId" resultType="com.juwon.springcommunity.domain.ProductImage">
        SELECT
            id,
            product_id,
            original_file_name,
            stored_file_name,
            file_path,
            file_size,
            created_date,
            modified_date
        FROM
            product_image
        WHERE
            product_id = #{productId}
    </select>

    <delete id="deleteByProductId">
        DELETE FROM product_image
        WHERE product_id = #{productId}
    </delete>

    <delete id="deleteById">
        DELETE FROM product_image
        WHERE id = #{id}
    </delete>

</mapper>
